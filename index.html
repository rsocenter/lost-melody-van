<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Lost Melody Van 🎶</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" href="icon.png" />
  <style>
    body {
      font-family: sans-serif;
      background: #f6edfc;
      color: #222;
      margin: 0;
      padding: 0;
    }
    header {
      text-align: center;
      padding: 1rem;
    }
    img.poster {
      max-width: 100%;
      height: auto;
      object-fit: contain;
      object-position: top center;
    }
    .controls {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin: 1rem;
    }
    .controls button, .controls a {
      padding: 0.5rem 1rem;
      font-size: 1rem;
    }
    .playlist {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    .playlist li {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.5rem;
      border-bottom: 1px solid #ccc;
    }
    .playlist li.active {
      background: #e0d0f5;
      font-weight: bold;
    }
    .counter {
      font-size: 0.8rem;
      margin-left: 1rem;
    }
    .search {
      width: 100%;
      padding: 0.5rem;
      font-size: 1rem;
      margin: 1rem auto;
      display: block;
    }
  </style>
</head>
<body>
  <header>
    <img src="poster.jpg" alt="Poster" class="poster"/>
    <h1>Lost Melody Van 🎶</h1>
    <input class="search" id="search" type="text" placeholder="🔍 Keresés..." oninput="filterSongs()"/>
    <div class="controls">
      <button onclick="setMode('sorban')">Sorban</button>
      <button onclick="setMode('veletlen')">Véletlen</button>
      <button onclick="toggleTheme()">🌙</button>
      <button onclick="shareApp()">📤</button>
      <a href="mailto:kovacsisa05@gmail.com">📧</a>
    </div>
  </header>

  <ul class="playlist" id="playlist">
    
    <li data-file="Soy Libre. (1).mp3">
      <span class="title">Soy Libre</span>
      <div class="actions">
        <a href="Soy Libre. (1).mp3" download title="Letöltés">⬇️</a>
        <span id="counter-0" class="counter">👁 0</span>
      </div>
    </li>
    
    <li data-file="Soy libre pepperappabum. (1).mp3">
      <span class="title">Soy libre papparapabumm</span>
      <div class="actions">
        <a href="Soy libre pepperappabum. (1).mp3" download title="Letöltés">⬇️</a>
        <span id="counter-1" class="counter">👁 0</span>
      </div>
    </li>
    
    <li data-file="Nem veszem be! (1).mp3">
      <span class="title">Nem veszem be</span>
      <div class="actions">
        <a href="Nem veszem be! (1).mp3" download title="Letöltés">⬇️</a>
        <span id="counter-2" class="counter">👁 0</span>
      </div>
    </li>
    
    <li data-file="Csak nosztalgia. (1).mp3">
      <span class="title">Csak nosztalgia</span>
      <div class="actions">
        <a href="Csak nosztalgia. (1).mp3" download title="Letöltés">⬇️</a>
        <span id="counter-3" class="counter">👁 0</span>
      </div>
    </li>
    
    <li data-file="Nosztalgia. (1).mp3">
      <span class="title">Nosztalgia</span>
      <div class="actions">
        <a href="Nosztalgia. (1).mp3" download title="Letöltés">⬇️</a>
        <span id="counter-4" class="counter">👁 0</span>
      </div>
    </li>
    
    <li data-file="Baila Baby! (1).mp3">
      <span class="title">Baila Baby</span>
      <div class="actions">
        <a href="Baila Baby! (1).mp3" download title="Letöltés">⬇️</a>
        <span id="counter-5" class="counter">👁 0</span>
      </div>
    </li>
    
    <li data-file="Őrült nyár! (1).mp3">
      <span class="title">Őrült nyár</span>
      <div class="actions">
        <a href="Őrült nyár! (1).mp3" download title="Letöltés">⬇️</a>
        <span id="counter-6" class="counter">👁 0</span>
      </div>
    </li>
    
    <li data-file="Ááhe! (1).mp3">
      <span class="title">Ááhe</span>
      <div class="actions">
        <a href="Ááhe! (1).mp3" download title="Letöltés">⬇️</a>
        <span id="counter-7" class="counter">👁 0</span>
      </div>
    </li>
    
    <li data-file="Fortuna kisasszony. (1).mp3">
      <span class="title">Fortuna kisasszony</span>
      <div class="actions">
        <a href="Fortuna kisasszony. (1).mp3" download title="Letöltés">⬇️</a>
        <span id="counter-8" class="counter">👁 0</span>
      </div>
    </li>
    
    <li data-file="Szerencse kisasszony. (1).mp3">
      <span class="title">Szerencse kisasszony</span>
      <div class="actions">
        <a href="Szerencse kisasszony. (1).mp3" download title="Letöltés">⬇️</a>
        <span id="counter-9" class="counter">👁 0</span>
      </div>
    </li>
    
    <li data-file="Csókolózni egyedül. (1).mp3">
      <span class="title">Csókolózni egyedül</span>
      <div class="actions">
        <a href="Csókolózni egyedül. (1).mp3" download title="Letöltés">⬇️</a>
        <span id="counter-10" class="counter">👁 0</span>
      </div>
    </li>
    
  </ul>

  <audio id="player" controls style="width:100%; margin-top:1rem;"></audio>

  <script>
    const player = document.getElementById("player");
    const playlist = document.getElementById("playlist").children;
    let current = 0;
    let mode = "sorban";

    function play(index) {
      current = index;
      const file = playlist[index].dataset.file;
      player.src = file;
      player.play();
      updateActive();
      incrementCount(index);
    }

    function updateActive() {
      [...playlist].forEach((li, i) => {
        li.classList.toggle("active", i === current);
      });
    }

    function setMode(m) {
      mode = m;
    }

    function toggleTheme() {
      document.body.classList.toggle("dark");
    }

    function shareApp() {
      if (navigator.share) {
        navigator.share({
          title: "Lost Melody Van",
          text: "Hallgasd meg!",
          url: window.location.href
        });
      }
    }

    function incrementCount(index) {
      fetch(`https://api.countapi.xyz/hit/lmv/song${index}`);
    }

    function loadCount(index) {
      fetch(`https://api.countapi.xyz/get/lmv/song${index}`)
        .then(r => r.json())
        .then(d => {
          document.getElementById("counter-" + index).innerText = `👁 ${d.value}`;
        });
    }

    function filterSongs() {
      const q = document.getElementById("search").value.toLowerCase();
      [...playlist].forEach(li => {
        const title = li.querySelector(".title").innerText.toLowerCase();
        li.style.display = title.includes(q) ? "flex" : "none";
      });
    }

    player.onended = () => {
      if (mode === "veletlen") {
        current = Math.floor(Math.random() * playlist.length);
      } else {
        current = (current + 1) % playlist.length;
      }
      play(current);
    };

    [...playlist].forEach((li, i) => {
      li.onclick = () => play(i);
      loadCount(i);
    });
  </script>
</body>
</html>
